large algorithm 180 error function 