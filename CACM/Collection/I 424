31 function algorithm gamma 