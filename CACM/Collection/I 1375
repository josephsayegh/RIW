function algorithm e4 minimization 251 