algorithm 78 ratfact 