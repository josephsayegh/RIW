algorithm integration modified r400 havie 