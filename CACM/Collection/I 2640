modified integration r400 havie algorithm 