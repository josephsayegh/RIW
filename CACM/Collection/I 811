smoothing algorithm 189 2 