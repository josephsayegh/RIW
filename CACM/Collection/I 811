smoothing algorithm 2 189 