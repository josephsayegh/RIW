smooth 216 algorithm 