derivatives algorithm s22 282 