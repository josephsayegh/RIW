function algorithm 31 gamma 