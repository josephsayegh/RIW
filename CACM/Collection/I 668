excess minimum curve cost algorithm 217 